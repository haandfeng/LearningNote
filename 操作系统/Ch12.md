# File System Performance
Block cache
Block read ahead
Reducing Disk-Arm Motion
## Block cache
A block cache or buffer cache is a collection of blocks that logically belong on the disk, but are kept in memory to improve performance.

All of the previous paging replacement algorithms can be used to determine which block should be written when a new block is needed and the cache is full.

- Periodically, all data block should be written out.
- UNIX - system call sync forces modified blocks out to the disk immediately. e.g. update runs in background during sync every 30 seconds-
- Windows has a similar System call: FlushFileBuffer
- MS-DOS - write-through cache => all modified blocks are written immediately.
e.g. write a 1K block one character at a time
			 UNIX collect them together
			 MS-DOS 1B at a time
## Block read ahead
Get blocks into the cache before they are needed
-  help increase the hit rate
- suitable for sequential read;
- not suitable for randomly accessed
- waste disk bandwidth by reading in useless blocks and may remove potentially useful blocks from the cache;

## Reducing Disk-Arm Motion
Reading a block needs one access for the i-node and one for the block. 
(a) I-nodes placed at the start of the disk
(b) Disk divided into cylinder groups, each with its own blocks and i-nodes.
![[Pasted image 20231228222839.png]]
	a) Old method                                                b)New method

# Defragmenting Disks
Fragmentation
1. Over time, files will be created and deleted, resulting in holes on the entire disk. 
2. When a new file is created, the blocks used for it may be spread all over the disk, giving poor performance.
Solution
1. Moving files around to make them contiguous and to put all (or at least most) of the free space in one or more large contiguous regions on the disk. 
2. Windows has a program, defrag. Windows users should run it regularly, except on SSDs.
## The MS-DOS File System
FAT-based method: take table pointer word from each block and put them in an index table, FAT (File Allocation Table), in memory.
![[Pasted image 20231228224531.png|325]]

Many digital cameras and MP3 players use it.
Use a fixed-size 32 byte directory entry.
![[Pasted image 20231228224636.png]]
The MS-DOS directory entry
