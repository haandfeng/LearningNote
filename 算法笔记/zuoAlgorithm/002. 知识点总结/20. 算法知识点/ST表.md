# ST表(Sparse Table)

---
https://blog.csdn.net/narcissus2_/article/details/89423591

>
可重复贡献问题
>
可重复贡献问题是对于运算opt，运算的性质满足x opt x = x，则对应的区间询问就是一个可重复的贡献问题，例如：最大值满足max(x,x)=x，最大公因数满gcd(x,x)=x，因此[[RMQ问题]]和[[RGQ问题|GCD问题]]就是一个可重复贡献的问题，但是例如区间和就不满足这个性质，因为在求解区间和的过程中采用的预处理区间会发生重叠，导致重叠部分被重复计算


ST表是一种数据结构，用来解决区间内的一些问题（比如可以求区间最小/大值、区间与, 区间GCD等），ST表采用的倍增的思想，我们在使用ST表的时候，可以做到o(nlogn)的时间建表，做到用o(1)的时间去查询

ST表的实现形式是使用了一个二维数组`f[i][j]`，数组的第一维存储的是当前总共拥有的数字下标(0~N-1)，数组的第二维存储的是从第i个数字开始的2^j个数字中的最值，递推边界则是`f[i][0] = a[i]`

在递推的时候，我们可以进行一个区间的分解，将一个2^j长度的区间分解成两个2^(j - 1)长度大小的区间, 对于求最大值就有如下的式子:

`f[i][j] = max(f[i][j - 1],f[i + 2^(j - 1)][j - 1])` 即 [[RMQ问题]]


## ST稀疏表可以解决什么问题？
[[RMQ问题]]和[[RGQ问题]]
- RMQ：区间最大最小值问题(Range Maximum/Minimum Query)
- RGQ：区间最大公约数问题(Range GCD Query)
- RAQ: 区间与问题(Range And Query)

如果一个大区间问题可以由两个小区间(这两个小区间的并集是这个大区间)得到，这两个小区间是否有重叠对大区间的结果没有任何影响。那么这类问题就可以用ST算法来做。



### ST表 Vs. 线段树

如果需要动态维护，需要添加或者删除，那么就必须用到线段树，线段树的单次查询时间为O(logn)，如果查询量大还是很浪费时间。
在不需要动态维护的时候，ST算法的查询速度可以到达O(1)

线段树预处理结构生成的代价是: `O(N*logN)`,  单次查询的代价: O(logN),  支持更新, 可以单点更新, 也可以范围更新

ST表预处理结构生成的代价是: `O(N*logN)`, 单次查询的代价: O(1), 但是**不支持更新**, 好处就是它的代码量非常的少
